---
permalink: san-config/update-emulex-hba-queue-depths-task.html 
sidebar: sidebar 
keywords: update, emulex, hba, queue, depths, linux, host 
summary: 您可以在 Linux 主机上更新 Emulex HBA 的队列深度。要使更新在重新启动后保持持久性，必须创建新的 RAM 磁盘映像并重新启动主机。 
---
= 更新 Linux 主机上的 Emulex HBA 队列深度
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以在 Linux 主机上更新 Emulex HBA 的队列深度。要使更新在重新启动后保持持久性，必须创建新的 RAM 磁盘映像并重新启动主机。

.步骤
. 确定要修改的队列深度参数：
+
`modinfo lpfc|grep queue_depth`

+
此时将显示队列深度参数及其问题描述的列表。根据您的操作系统版本，您可以修改以下一个或多个队列深度参数：

+
** `lpfc_lun_queue_depth` ：可排队到特定 LUN 的最大 FC 命令数（ uint ）
** `lpfc_hba_queue_depth` ：可排队到 lpfc HBA 的最大 FC 命令数（ uint ）
** `lpfc_tgt_queue_depth` ：可排队到特定目标端口（ uint ）的最大 FC 命令数
+
`lpfc_tgt_queue_depth` 参数仅适用于 Red Hat Enterprise Linux 7.x 系统， SUSE Linux Enterprise Server 11 SP4 系统和 12.x 系统。



. 通过将队列深度参数添加到 Red Hat Enterprise Linux 5.x 系统的 ` /etc/modprobe.conf` 文件以及 Red Hat Enterprise Linux 6.x 或 7.x 系统或 SUSE Linux Enterprise Server 11.x 或 12.x 系统的 ` /etc/modprobe.d/scsi.conf` 文件来更新队列深度。
+
根据您的操作系统版本，您可以添加以下一个或多个命令：

+
** `options lpfc lpfc_HBA_queue_depth=new_queue_depth`
** `options lpfc lpfc_lun_queue_depth=new_queue_depth`
** `options lpfc_tgt_queue_depth=new_queue_depth`


. 创建新的 RAM 磁盘映像，然后重新启动主机，使更新在重新启动后保持不变。
+
有关详细信息，请参见适用于您的 Linux 操作系统版本的《系统管理参考指南》。

. 验证是否已为您修改的每个队列深度参数更新队列深度值：
+
`cat /sys/class/scsi_host/host_number/lpfc_lun_queue_depth``cat /sys/class/scsi_host/host_number/lpfc_tgt_queue_depth``cat /sys/class/scsi_host/host_number/lpfc_hba_queue_depth`

+
[listing]
----
root@localhost ~]#cat /sys/class/scsi_host/host5/lpfc_lun_queue_depth
      30
----
+
此时将显示队列深度的当前值。



* 相关信息 *

link:../system-admin/index.html["系统管理"]
