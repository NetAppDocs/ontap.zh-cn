---
permalink: san-config/fc-fcoe-recommended-zoning-configuration.html 
sidebar: sidebar 
keywords: individual zones 
summary: 在建议的FC和FCoE分区配置中、每个分区有一个主机启动程序。此分区由主机启动程序端口和存储节点上的一个或多个目标 LIF 组成，这些 LIF 可提供对 LUN 的访问权限，但不能超过每个目标所需的路径数。此配置允许每个主机启动程序访问任何节点、同时防止访问同一节点的主机看到彼此的端口 
---
= 为ONTAP系统建议的FC和FCoE分区配置
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
如果主机未安装多路径解决方案、四个或更多主机连接到SAN或集群中的节点未实施选择性LUN映射、则应创建分区配置。

在建议的FC和FCoE分区配置中、每个分区包括一个主机启动程序、主机启动程序端口以及一个或多个目标生命周期。此配置允许每个主机启动程序访问任何节点、同时防止访问同一节点的主机看到彼此的端口

将Storage Virtual Machine (SVM)中的所有SVM添加到具有主机启动程序的分区中。这样，您无需编辑现有分区或创建新分区，即可移动卷或 LUN 。



== 双网络结构分区配置

建议使用双网络结构分区配置、因为它们可以防止因单个组件故障而导致数据丢失。在双网络结构配置中、每个主机启动程序都使用不同的交换机连接到集群中的每个节点。如果一台交换机不可用、则会通过另一台交换机保持数据访问。要管理多个路径，需要在主机上安装多路径软件。

在下图中，主机具有两个启动程序，并且正在运行多路径软件。有两个分区。link:../san-admin/selective-lun-map-concept.html["选择性LUN映射(SLM)"]配置为将所有节点视为报告节点。

[NOTE]
====
此图中使用的命名约定只是建议您可以选择对 ONTAP 解决方案使用一种可能的命名约定。

====
* 分区1：HBA 0、LIF_1、LIF_3、LIF_5和LIF_7
* 分区2：HBA 1、LIF_2、LIF_4、LIF_6和LIF_8


每个主机启动程序都通过不同的交换机进行分区。分区 1 通过交换机 1 进行访问。分区2通过交换机2访问。

每个主机都可以访问每个节点上的LIF。这样，当节点出现故障时，主机仍可访问其 LUN 。根据您的SLM报告节点配置、SVM可以访问集群中每个节点上的所有iSCSI和FC LUN。您可以使用 SLM ，端口集或 FC 交换机分区来减少从 SVM 到主机的路径数以及从 SVM 到 LUN 的路径数。

如果此配置包含更多节点、则这些分区中会包含更多节点的生命周期。

image:scm-en-drw-dual-fabric-zoning.png["双网络结构分区"]

[NOTE]
====
主机操作系统和多路径软件必须支持用于访问节点上 LUN 的路径数。

====


== 单网络结构分区

在单网络结构配置中、可以通过一个交换机将每个主机启动程序连接到每个存储节点。建议不要使用单网络结构分区配置、因为它们无法防止因单个组件故障而导致数据丢失。如果您选择配置单网络结构分区、则每个主机都应具有两个多路径启动程序、以便在解决方案中提供故障恢复能力。要管理多个路径，需要在主机上安装多路径软件。

每个主机启动程序应至少从该启动程序可以访问的每个节点创建一个LIF。分区应至少允许从主机启动程序到集群中的 HA 节点对的一条路径，以便为 LUN 连接提供一条路径。这意味着，在其分区配置中，主机上的每个启动程序在每个节点上可能只有一个目标 LIF 。如果需要使用多路径连接到集群中的同一节点或多个节点，则每个节点在其分区配置中将具有多个 LIF 。这样，如果某个节点出现故障或包含 LUN 的卷移动到其他节点，主机仍可访问其 LUN 。这还要求正确设置报告节点。

使用 Cisco FC 和 FCoE 交换机时，一个网络结构分区不能为同一物理端口包含多个目标 LIF 。如果同一端口上的多个 LIF 位于同一分区中，则 LIF 端口可能无法从连接丢失中恢复。

在下图中，主机具有两个启动程序，并且正在运行多路径软件。有两个分区：

[NOTE]
====
此图中使用的命名约定只是建议您可以选择对 ONTAP 解决方案使用一种可能的命名约定。

====
* 分区 1 ： HBA 0 ， LIF_1 和 LIF_3
* 分区2：HBA 1、LIF_2和LIF_4


如果此配置包含更多节点、则这些分区中会包含更多节点的生命周期

image:scm-en-drw-single-fabric-zoning.png["单网络结构分区"]

在此示例中，每个分区中也可以包含所有四个 LIF 。在这种情况下，分区如下所示：

* 分区 1 ： HBA 0 ， LIF_1 ， LIF_2 ， LIF_3 和 LIF_4
* 区域 2 ： HBA 1 ， LIF_1 ， LIF_2 ， LIF_3 和 LIF_4


[NOTE]
====
主机操作系统和多路径软件必须支持用于访问节点上 LUN 的支持路径数。要确定用于访问节点上 LUN 的路径数，请参见 SAN 配置限制一节。

====


== Cisco FC 和 FCoE 交换机的分区限制

使用Cisco FC和FCoE交换机时、对在分区中使用物理端口和逻辑接口(Logical Interface、Lifs)存在某些限制。

.物理端口
* FC-NVMe和FC可以共享同一个32 Gb物理端口
* FC-NVMe和FCoE不能共享同一物理端口
* FC和FCoE可以共享同一物理端口、但其协议LIP必须位于不同的分区中。


.逻辑接口 (LIF)
* 一个分区可以包含集群中每个目标端口的LIF。
+
请验证SLM配置、以确保不会超过主机允许的最大路径数。

* 给定端口上的每个LIF必须与该端口上的其他LIF位于不同的分区中
* 不同物理端口上的 LIF 可以位于同一分区中。

