---
permalink: smb-admin/server-options-reference.html 
sidebar: sidebar 
keywords: useful, option, available, consider, customize, smb, cifs, server, general, enable, configure, functionality, vserver, modify, available smb server options 
summary: 在考虑如何自定义 SMB 服务器时，了解哪些选项可用非常有用。虽然某些选项在 SMB 服务器上通用，但也有一些选项用于启用和配置特定的 SMB 功能。SMB 服务器选项可通过 vserver cifs options modify 选项进行控制。 
---
= 可用的ONTAP SMB服务器选项
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
在考虑如何自定义 SMB 服务器时，了解哪些选项可用非常有用。虽然某些选项在 SMB 服务器上通用，但也有一些选项用于启用和配置特定的 SMB 功能。SMB服务器选项可通过控制 `vserver cifs options modify` 选项

以下列表指定了在管理员权限级别可用的 SMB 服务器选项：

* * 配置 SMB 会话超时值 *
+
通过配置此选项，您可以指定断开 SMB 会话之前空闲时间的秒数。空闲会话是指用户未在客户端上打开任何文件或目录的会话。默认值为900秒。

* * 配置默认 UNIX 用户 *
+
通过配置此选项，您可以指定 SMB 服务器使用的默认 UNIX 用户。ONTAP 会自动创建一个名为 "`pcuser` " 的默认用户（ UID 为 65534 ），创建一个名为 "`pcuser` " 的组（ GID 为 65534 ），并将默认用户添加到 "`pcuser` " 组。创建 SMB 服务器时， ONTAP 会自动将 "`pcuser` " 配置为默认 UNIX 用户。

* * 配置子系统 UNIX 用户 *
+
通过配置此选项，您可以指定从不可信域登录的用户映射到的 UNIX 用户的名称，从而允许来自不可信域的用户连接到 SMB 服务器。默认情况下，不会配置此选项（没有默认值）；因此，默认情况下不允许来自不可信域的用户连接到 SMB 服务器。

* * 启用或禁用模式位的读取授予执行 *
+
通过启用或禁用此选项，您可以指定是否允许 SMB 客户端使用其具有读取访问权限的 UNIX 模式位运行可执行文件，即使未设置 UNIX 可执行位也是如此。默认情况下，此选项处于禁用状态。

* * 启用或禁用从 NFS 客户端删除只读文件的功能 *
+
启用或禁用此选项将确定是否允许 NFS 客户端删除设置了只读属性的文件或文件夹。设置只读属性后， NTFS 删除语义不允许删除文件或文件夹。UNIX 删除语义将忽略只读位，而是使用父目录权限来确定是否可以删除文件或文件夹。默认设置为 `disabled`，这会导致NTFS删除义。

* * 配置 Windows Internet 名称服务服务器地址 *
+
通过配置此选项，您可以将 Windows Internet 名称服务（ WINS ）服务器地址列表指定为逗号分隔列表。您必须指定 IPv4 地址。不支持 IPv6 地址。没有默认值。



以下列表指定了在高级权限级别可用的 SMB 服务器选项：

* * 向 CIFS 用户授予 UNIX 组权限 *
+
配置此选项可确定是否可以向不是文件所有者的传入 CIFS 用户授予组权限。如果CIFS用户不是UNIX安全模式文件的所有者、并且此参数设置为 `true`，则为该文件授予组权限。如果CIFS用户不是UNIX安全模式文件的所有者、并且此参数设置为 `false`则可以使用常规UNIX规则授予文件权限。此参数适用于权限设置为的UNIX安全模式文件 `mode bits` 和不适用于采用NTFS或NFSv4安全模式的文件。默认设置为 `false`。

* * 启用或禁用 SMB 1.0*
+
默认情况下，在 ONTAP 9.3 中为其创建 SMB 服务器的 SVM 上禁用 SMB 1.0 。

+
[NOTE]
====
从 ONTAP 9.3 开始，默认情况下，对于在 ONTAP 9.3 中创建的新 SMB 服务器， SMB 1.0 处于禁用状态。您应尽快迁移到更高版本的 SMB ，以便为增强安全性和合规性做好准备。有关详细信息，请联系您的 NetApp 代表。

====
* * 启用或禁用 SMB 2.x *
+
SMB 2.0 是支持 LIF 故障转移的最低 SMB 版本。如果禁用 SMB 2.x ，则 ONTAP 还会自动禁用 SMB 3.x

+
SMB 2.0 仅在 SVM 上受支持。默认情况下，此选项在 SVM 上处于启用状态

* *启用或禁用SMB 3.0*
+
SMB 3.0 是支持持续可用共享的最低 SMB 版本。Windows Server 2012 和 Windows 8 是支持 SMB 3.0 的最低 Windows 版本。

+
SMB 3.0仅在SVM上受支持。默认情况下，此选项在 SVM 上处于启用状态

* *启用或禁用SMB 3.1*
+
Windows 10 是唯一支持 SMB 3.1 的 Windows 版本。

+
SMB 3.1仅在SVM上受支持。默认情况下，此选项在 SVM 上处于启用状态

* * 启用或禁用 ODX 副本卸载 *
+
ODX 副本卸载由支持它的 Windows 客户端自动使用。默认情况下，此选项处于启用状态。

* * 启用或禁用 ODX 副本卸载的直接复制机制 *
+
如果 Windows 客户端尝试以防止在复制过程中更改文件的模式打开副本的源文件，则直接复制机制可以提高副本卸载操作的性能。默认情况下，直接复制机制处于启用状态。

* * 启用或禁用自动节点转介 *
+
对于自动节点转介， SMB 服务器会自动将客户端转介到托管通过请求的共享访问的数据的节点的本地数据 LIF 。

* * 启用或禁用 SMB 的导出策略 *
+
默认情况下，此选项处于禁用状态。

* * 启用或禁用使用接合点作为重新解析点 *
+
如果启用此选项，则 SMB 服务器会将接合点作为重新解析点公开给 SMB 客户端。此选项仅适用于 SMB 2.x 或 SMB 3.0 连接。默认情况下，此选项处于启用状态。

+
此选项仅在 SVM 上受支持。默认情况下，此选项在 SVM 上处于启用状态

* * 配置每个 TCP 连接的最大并发操作数 *
+
默认值为255。

* * 启用或禁用本地 Windows 用户和组功能 *
+
默认情况下，此选项处于启用状态。

* * 启用或禁用本地 Windows 用户身份验证 *
+
默认情况下，此选项处于启用状态。

* * 启用或禁用 VSS 卷影复制功能 *
+
ONTAP 使用卷影复制功能对使用 Hyper-V over SMB 解决方案存储的数据执行远程备份。

+
此选项仅在 SVM 上受支持，并且仅适用于基于 SMB 的 Hyper-V 配置。默认情况下，此选项在 SVM 上处于启用状态

* * 配置卷影复制目录深度 *
+
通过配置此选项，您可以定义在使用卷影复制功能时要创建卷影副本的目录的最大深度。

+
此选项仅在 SVM 上受支持，并且仅适用于基于 SMB 的 Hyper-V 配置。默认情况下，此选项在 SVM 上处于启用状态

* * 启用或禁用名称映射的多域搜索功能 *
+
如果启用了此选项，则在使用 Windows 用户名的域部分（例如， *\joe ）中的通配符（ * ）将 UNIX 用户映射到 Windows 域用户时， ONTAP 将在对主域具有双向信任的所有域中搜索指定用户。主域是包含 SMB 服务器计算机帐户的域。

+
除了搜索所有双向受信任域之外，您还可以配置首选受信任域的列表。如果启用了此选项并配置了首选列表，则会使用首选列表执行多域名称映射搜索。

+
默认情况下，启用多域名称映射搜索。

* * 配置文件系统扇区大小 *
+
通过配置此选项，您可以配置 ONTAP 向 SMB 客户端报告的文件系统扇区大小（以字节为单位）。此选项有两个有效值： `4096` 和 `512`。默认值为 `4096`。您可能需要将此值设置为 `512` 如果Windows应用程序仅支持512字节的扇区大小。

* * 启用或禁用动态访问控制 *
+
启用此选项后，您可以使用动态访问控制（ DAC ）来保护 SMB 服务器上的对象，包括使用审核暂存中央访问策略以及使用组策略对象实施中央访问策略。默认情况下，此选项处于禁用状态。

+
此选项仅在 SVM 上受支持。

* * 设置非身份验证会话的访问限制（限制匿名） *
+
设置此选项可确定非身份验证会话的访问限制。这些限制将应用于匿名用户。默认情况下，匿名用户没有访问限制。

* * 启用或禁用在具有 UNIX 有效安全性的卷（ UNIX 安全模式卷或具有 UNIX 有效安全性的混合安全模式卷）上呈现 NTFS ACL *
+
启用或禁用此选项可确定如何向 SMB 客户端提供具有 UNIX 安全性的文件和文件夹的文件安全性。如果启用，则 ONTAP 会将具有 UNIX 安全性的卷中的文件和文件夹呈现给 SMB 客户端，并将其视为具有 NTFS ACL 的 NTFS 文件安全性。如果禁用，则 ONTAP 会将具有 UNIX 安全性的卷显示为 FAT 卷，而不会提供文件安全性。默认情况下，卷显示为具有 NTFS ACL 的 NTFS 文件安全性。

* * 启用或禁用 SMB 虚假打开功能 *
+
启用此功能可优化 ONTAP 在查询文件和目录上的属性信息时发出打开和关闭请求的方式，从而提高 SMB 2.x 和 SMB 3.0 的性能。默认情况下， SMB fake open 功能处于启用状态。此选项仅适用于使用 SMB 2.x 或更高版本建立的连接。

* * 启用或禁用 UNIX 扩展 *
+
启用此选项可在 SMB 服务器上启用 UNIX 扩展。UNIX 扩展允许通过 SMB 协议显示 POSIX/UNIX 模式的安全性。默认情况下，此选项处于禁用状态。

+
如果您的环境中有基于 UNIX 的 SMB 客户端，例如 Mac OSX 客户端，则应启用 UNIX 扩展。启用 UNIX 扩展后， SMB 服务器可以通过 SMB 将 POSIX/UNIX 安全信息传输到基于 UNIX 的客户端，然后将安全信息转换为 POSIX/UNIX 安全。

* * 启用或禁用对短名称搜索的支持 *
+
启用此选项可使 SMB 服务器对短名称执行搜索。启用了此选项的搜索查询会尝试匹配 8.3 文件名和长文件名。此参数的默认值为 `false`。

* * 启用或禁用对自动公布 DFS 功能的支持 *
+
启用或禁用此选项可确定 SMB 服务器是否自动向连接到共享的 SMB 2.x 和 SMB 3.0 客户端公布 DFS 功能。ONTAP 在实施用于 SMB 访问的符号链接时使用 DFS 转介。如果启用，则无论是否启用符号链接访问， SMB 服务器都会始终公布 DFS 功能。如果禁用，则只有当客户端连接到启用了符号链接访问的共享时， SMB 服务器才会公布 DFS 功能。

* * 配置最大 SMB 信用数 *
+
从ONTAP 9.4开始、配置 `-max-credits` 选项允许您限制在客户端和服务器运行SMB版本2或更高版本时在SMB连接上授予的信用值数量。默认值为128。

* * 启用或禁用对 SMB 多通道的支持 *
+
启用 `-is-multichannel-enabled` 如果在集群及其客户端上部署了适当的NIC、则ONTAP 9.4及更高版本中的选项允许SMB服务器为单个SMB会话建立多个连接。这样可以提高吞吐量和容错能力。此参数的默认值为 `false`。

+
启用 SMB 多通道后，您还可以指定以下参数：

+
** 每个多通道会话允许的最大连接数。此参数的默认值为 32 。
** 每个多通道会话公布的最大网络接口数。此参数的默认值为256。



