---
permalink: mediator/index.html 
sidebar: sidebar 
keywords: ontap mediator, install requirements, mediator requirements 
summary: 要安装 ONTAP Mediator，您必须确保满足所有先决条件、获取安装包并在主机上运行安装程序。 
---
= 安装或升级ONTAP Mediator
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
要安装或升级ONTAP Mediator，您需要满足所有先决条件，下载安装包，并在主机上运行安装程序。

* 从ONTAP 9.8开始、您可以使用任何版本的ONTAP调解器监控SnapMirror活动同步关系。
* 您可以使用任何版本的ONTAP Mediator 来监控MetroCluster IP 配置。




== 安装和升级注意事项

在升级或安装ONTAP Mediator 之前，请先查看以下几点。


NOTE: ONTAP Mediator 1.8 及更早版本与 Red Hat Enterprise Linux (RHEL) FIPS 模式不兼容，导致无法成功安装。您可以使用以下命令检查是否启用了 FIPS 模式： `fips-mode-setup --check`命令。您可以使用以下方法禁用 FIPS 模式： `fips-modesetup --disable`命令。禁用 FIPS 模式后重新启动以成功安装ONTAP Mediator 1.8 或更早版本。

* 您应该将ONTAP Mediator 升级到最新版本。旧版本仍然可以与所有ONTAP版本兼容，但新版本包含针对第三方组件的安全补丁。
* 升级到新的ONTAP调解器版本时、安装程序会自动升级到建议的SCST版本、除非有更高版本可用。有关手动安装较高版本SCST的说明，请参阅link:manage-task.html["管理ONTAP调解器"]。有关支持的版本，请参见link:whats-new-concept.html#scst-support-matrix["SCST支持列表"]。


[NOTE]
====
* 如果安装失败，您可能需要升级到更新版本的ONTAP Mediator。
* 自 2025 年 6 月 15 日起，您无法安装或升级ONTAP Mediator 1.9 和 1.8，因为它们的代码签名证书已过期。如果安装或升级失败，请改用ONTAP Mediator 1.9.1 补丁版本。


====
* 如果安装 `yum-utils` 软件包中、您可以使用 `needs-restarting` 命令：
* 从ONTAP Mediator 1.11 开始， MetroCluster IP 配置支持 IPv6。




=== 主机要求

安装 RHEL 或 Rocky Linux 并配置相关存储库时，请遵循这些要求。

[NOTE]
====
如果您修改安装或配置过程、则可能需要执行其他步骤。

====
.Linux分发要求
* 按照红帽最佳实践安装 RHEL 或 Rocky Linux。由于 CentOS 8.x 已停止维护，因此不建议使用与 CentOS 8.x 兼容的版本。
* 安装 ONTAP Mediator 时，请确保系统可以访问所需的存储库，以便安装程序可以检索并安装所有必需的软件依赖项。
* 要使yum安装程序能够在RHEL存储库中查找相关软件、请在安装期间或之后使用有效的Red Hat订阅注册系统。
+
[NOTE]
====
有关详细信息、请参见Red Hat订阅管理器文档。

====


.网络要求
确保以下端口可用于ONTAP调解器且未使用：

|===


| 端口 / 服务 | 源 | 方向 | 目标 | 目的 


 a| 
22 TCP
 a| 
管理主机
 a| 
入站
 a| 
ONTAP 调解器
 a| 
(可选) SSH / ONTAP调解器管理



 a| 
31784 TCP
 a| 
集群管理 LIF
 a| 
入站
 a| 
ONTAP 调解器 Web 服务器
 a| 
(必需) REST API (HTTPS)



 a| 
3260/TCP ^1^
 a| 
节点数据文件或节点管理文件
 a| 
双向
 a| 
ONTAP 调解器 iSCSI 目标
 a| 
（ MetroCluster IP 配置必需）邮箱的 iSCSI 数据连接

|===
对于SMBC客户、ONTAP不需要启用或连接端口3260。

* 如果使用第三方防火墙，请参阅link:https://docs.netapp.com/us-en/ontap-metrocluster/install-ip/concept_mediator_requirements.html#firewall-requirements-for-ontap-mediator["ONTAP 调解器的防火墙要求"^]。
* 对于无法访问Internet的Linux主机、请确保所需的软件包在本地存储库中可用。
+
如果您在Linux环境中使用链路聚合控制协议(Link Aggregation" Control Protocol, LacP)，请配置内核并将设置 `sysctl net.ipv4.conf.all.arp_ignore`为 `2`。



.操作系统要求
您的操作系统必须满足以下要求：

* 64 位物理安装或虚拟机
* 8 GB RAM
* 1 GB磁盘空间(用于应用程序安装、服务器日志和数据库)
* 用户： root 访问权限


下表显示了每个版本的ONTAP调解器支持的操作系统。

[cols="30,70"]
|===


| ONTAP 调解器版本 | 支持的 Linux 版本 


 a| 
1.11
 a| 
* Red Hat Enterprise Linux
+
** 兼容：9.5 ^1^
** 推荐：10.1、10.0、9.7、9.6、9.4 和 8.10


* Rocky Linux 10.1、9.7 和 8.10
* Oracle Linux 10.0 和 9.6




 a| 
1.10
 a| 
* Red Hat Enterprise Linux
+
** 兼容：9.5 ^1^
** 推荐：10.0、9.6、9.4 和 8.10


* Rocky Linux 10.0、9.6 和 8.10




 a| 
1.9.1
 a| 
* Red Hat Enterprise Linux
+
** 兼容：9.3、9.1、8.9、8.7、8.6、8.5 和 8.4 ^1^
** 推荐：9.5、9.4、9.2、9.0、8.10 和 8.8


* Rocky Linux 9.5 和 8.10




 a| 
1.9
 a| 
* Red Hat Enterprise Linux
+
** 兼容：9.3、9.1、8.9、8.7、8.6、8.5 和 8.4 ^1^
** 推荐：9.5、9.4、9.2、9.0、8.10 和 8.8


* Rocky Linux 9.5 和 8.10




 a| 
1.8.
 a| 
* 红帽企业 Linux：
+
** 兼容：8.7、8.6、8.5 和 8.4 ^1^
** 推荐：9.4、9.3、9.2、9.1、9.0、8.10、8.9 和 8.8


* Rocky Linux 9.4 和 8.10




 a| 
1.7.
 a| 
* 红帽企业 Linux：
+
** 兼容：8.7、8.6、8.5 和 8.4 ^1^
** 推荐：9.3、9.2、9.1、9.0、8.9 和 8.8


* Rocky Linux 9.3 和 8.9




 a| 
1.6.
 a| 
* 红帽企业 Linux：
+
** 兼容：8.7、8.6、8.5 和 8.4 ^1^
** 推荐：9.2、9.1、9.0 和 8.8


* Rocky Linux 9.2 和 8.8




 a| 
1.5.
 a| 
* Red Hat Enterprise Linux：8.5、8.4、8.3、8.2、8.1、8.0、7.9、7.8、7.7 和 7.6
* CentOS：7.9、7.8、7.7 和 7.6




 a| 
1.4.
 a| 
* Red Hat Enterprise Linux：8.5、8.4、8.3、8.2、8.1、8.0、7.9、7.8、7.7 和 7.6
* CentOS：7.9、7.8、7.7 和 7.6




 a| 
1.3.
 a| 
* Red Hat Enterprise Linux：8.3、8.2、8.1、8.0、7.9、7.8、7.7 和 7.6
* CentOS：7.9、7.8、7.7 和 7.6




 a| 
1.2.
 a| 
* Red Hat Enterprise Linux：8.1、8.0、7.9、7.8、7.7 和 7.6
* CentOS：7.9、7.8、7.7 和 7.6


|===
. 兼容意味着 Red Hat 不再支持这些 RHEL 版本，但仍可在这些版本上安装ONTAP Mediator。


.操作系统所需的软件包
ONTAP 调解器需要以下软件包：


NOTE: 软件包可以是预安装的、也可以是由ONTAP调解器安装程序自动安装的。

[cols="25,25,25,25"]
|===


| 所有 RHEL/CentOS 版本 | RHEL 10.x / Rocky Linux 10 的附加软件包 | 适用于RHEL 9.x / Rocky Linux 9的其他软件包 | 适用于RHEL 8.x / Rocky Linux 8的其他软件包 


 a| 
* OpenSSL
* OpenSSL 开发
* kernel-devel-$(uname -r)
* GCC
* 创建
* libselinux-utils
* patch
* bzip 2
* Perl 数据 - Dumper
* Perl 扩展程序 -MakeMaker
* efibootmgr
* mukutil

 a| 
* python3.12
* python3.12-devel

 a| 
* elfutils-libelf-devel
* policycoreutils-python 实用程序
* python3.
* python3-devel

 a| 
* elfutils-libelf-devel
* policycoreutils-python 实用程序
* RedHat-lsb-core
* python39
* python39-devel


|===
调解器安装包是一个自解压压缩 tar 文件，其中包括：

* 一个 RPM 文件，其中包含无法从受支持版本的存储库获取的所有依赖项。
* 安装脚本。


建议使用有效的SSL证书。



=== 操作系统升级注意事项和内核兼容性

* 您可以更新除内核之外的所有库软件包，但您可能需要重新启动才能使ONTAP Mediator 中的更改生效。如果需要重启，请安排停机时间。
* 你应该保持操作系统内核处于最新状态。将内核核心升级到列表中列出的受支持版本。link:whats-new-concept.html#scst-support-matrix["ONTAP调解器版本表"] 。您必须重启系统，因此请为此次停机维护安排一个时间段。
+
** 重启前卸载 SCST 内核模块，重启后再重新安装。
** 在开始内核操作系统升级之前，请准备好受支持的 SCST 版本进行重新安装。




[NOTE]
====
* 内核版本必须与操作系统版本匹配。
* 请勿将内核升级到ONTAP Mediator 版本支持的操作系统版本以上，因为测试过的 SCST 模块可能无法正常工作。


====


== 启用UEFI安全启动时安装ONTAP调解器

ONTAP调解器可以安装在启用或不启用UEFI安全启动的系统上。

.关于此任务
如果不需要UEFI安全启动、或者您要对调解器安装问题进行故障排除、则可以选择在安装ONTAP调解器之前禁用ONTAP安全启动。从计算机设置中禁用UEFI安全启动选项。

[NOTE]
====
有关禁用UEFI安全启动的详细说明、请参阅适用于您的主机操作系统的文档。

====
要安装启用了 UEFI 安全启动的 ONTAP Mediator，您必须先注册安全密钥，然后服务才能启动。密钥是在SCST安装的编译步骤中生成的、并保存为计算机上的私有-公共密钥对。使用 `mokutil`实用程序将公共密钥作为计算机所有者密钥(Machine Owner Key、MOK)添加到UEFI固件中、以使系统信任并加载签名模块。请将密码短语保存 `mokutil`在安全位置、因为在重新启动系统以激活MOK时需要使用此密码短语。

.步骤
. [[STEP_1_UEFI]]检查系统上是否启用了UEFI安全启动：
+
`mokutil --sb-state`

+
结果指示此系统是否已启用UEFI安全启动。

+
[cols="40,60"]
|===


| 条件 | 转至 ... 


 a| 
已启用UEFI安全启动
 a| 




 a| 
已禁用UEFI安全启动
 a| 
link:upgrade-host-os-mediator-task.html["升级主机操作系统，然后升级 ONTAP Mediator"]

|===
+
[NOTE]
====
** 系统会提示您创建密码短语、必须将其存储在安全位置。要在UEFI引导管理器中启用密钥、您需要使用此密码短语。
** ONTAP 1.2.0及更早版本不支持此模式。


====
. [[STEP_2_UEFI]]如果 `mokutil`未安装实用程序、请运行以下命令：
+
`yum install mokutil`


